import os, json, zipfile, threading, requests, re, smtplib, traceback, hashlib
from datetime import datetime, date, time as t, timedelta, timezone
from io import BytesIO
from email.message import EmailMessage
from urllib.parse import unquote_plus
import base64 # Dodato za eventualnu pomoć oko base64

import streamlit as st
from streamlit.runtime.scriptrunner import add_script_run_ctx

# ─────────── konstante ───────────
DEFAULT_TOKEN = "975449712b54d5463a9bc22eddfacb006D57EA7D1C7F73A4690338D42F14313ED12D0C1F"
DATE_RE  = re.compile(r"20\d{6}")               # YYYYMMDD u imenu fajla
EU_BG    = timezone(timedelta(hours=2))         # Europe/Belgrade
SETFILE  = "smtp_settings.json"
TIMERKEY = "auto_timer"

# Base64 string vašeg loga - ZAMENITE OVO!
# Primer: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUA..."
# Ako je logo veliki, ovaj string može biti veoma dugačak.
# Možete ga staviti i u zasebnu datoteku i učitati, ili direktno ovde.
LOGO_BASE64 = "data:image/png;base64,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"
# ─────────── pomoćne ────────────
def normalize_base_url(u: str) -> str:
    u = u.rstrip("/")
    return u + "/wialon/ajax.html" if not u.endswith("/wialon/ajax.html") else u

def sha(p: str) -> str:  # SHA-256 heš lozinke
    return hashlib.sha256(p.encode()).hexdigest()

def load_settings() -> dict:
    if os.path.exists(SETFILE):
        try:  return json.load(open(SETFILE, encoding="utf-8"))
        except Exception: pass
    return {}

def save_settings(s: dict) -> None:
    json.dump(s, open(SETFILE, "w", encoding="utf-8"))

def wialon_call(svc: str, sid: str, params: dict | None, base: str, *, get=False):
    payload = {"svc": svc, "sid": sid}
    if params is not None:
        payload["params"] = json.dumps(params, separators=(",", ":"))
    req = requests.get if get else requests.post
    r = req(base,
            params=payload if get else None,
            data=payload if not get else None,
            timeout=20)
    r.raise_for_status() # Dodato da baca grešku za HTTP greške
    return r.json()

# ─────────── Wialon API ─────────
def login_token(token: str, base: str) -> str | None:
    try:
        # Params treba da bude JSON string za GET zahteve takođe, prema Wialon specifikaciji
        # Mada za token/login, requests će ga URL-enkodirati ispravno ako je dict
        r_json = wialon_call("token/login", "", {"token": token}, base, get=True) # SID je prazan za login
        if "error" in r_json: raise RuntimeError(f"Wialon error: {r_json}")
        return r_json.get("eid")
    except requests.exceptions.RequestException as re:
        st.error(f"Network error during login: {re}")
        return None
    except RuntimeError as e:
        st.error(e)
        return None
    except Exception as e:
        st.error(f"An unexpected error occurred during login: {e}")
        return None


def get_units(sid: str, base: str):
    res = wialon_call("core/search_items", sid,
        {"spec": {"itemsType": "avl_unit", "propName": "sys_name",
                  "propValueMask": "*", "sortType": "sys_name"},
         "force": 1, "flags": 1, "from": 0, "to": 0}, base)
    if "error" in res: raise RuntimeError(f"Wialon error getting units: {res}")
    return [{"id": it["id"],
             "name": it.get("nm", "N/A"),
             "reg": it.get("prp", {}).get("reg_number", "")} for it in res["items"]]

def list_files(sid: str, uid: int, day: date, base: str):
    res = wialon_call("file/list", sid,
        {"itemId": uid, "storageType": 2, "path": "tachograph/",
         "mask": "*", "recursive": False, "fullPath": False}, base)
    if isinstance(res, dict) and "error" in res: raise RuntimeError(f"Wialon error listing files: {res}")

    out = []
    for f in res:
        # Provera po vremenu kreiranja/modifikacije
        file_date_match = False
        for key in ("ct", "mt"): # ct = creation time, mt = modification time
            if key in f:
                try:
                    file_dt = datetime.fromtimestamp(f[key], tz=timezone.utc)
                    if file_dt.astimezone(EU_BG).date() == day: # Poredi datume u lokalnoj EU_BG zoni
                        file_date_match = True
                        break
                except Exception: # Za slučaj da timestamp nije validan
                    pass 
        
        if file_date_match:
            out.append(f)
        else:
            # Provera po imenu fajla kao fallback
            m = DATE_RE.search(f.get("n", "")) # f["n"] je ime fajla
            if m:
                try:
                    if datetime.strptime(m.group(), "%Y%m%d").date() == day:
                        out.append(f)
                except ValueError: # Za slučaj da datum u imenu nije validan
                    pass
                        
    out.sort(key=lambda x: x.get("mt", x.get("ct", 0)), reverse=True)
    return out

def get_file(sid: str, uid: int, fname: str, base: str) -> bytes | None:
    # Za file/get, parametri idu direktno u URL, ne kao JSON string 'params'
    # Vraćam se na originalni način slanja params
    params_payload = {"itemId": uid, "storageType": 2, "path": f"tachograph/{fname}"}
    r = requests.get(base,
        params={"svc": "file/get", "sid": sid, "params": json.dumps(params_payload)}, 
        timeout=30) # Povećan timeout za download fajlova
    
    if r.status_code == 200:
        # Provera da li je odgovor greška u JSON formatu
        try:
            json_error = r.json()
            if "error" in json_error:
                st.error(f"Wialon API error while fetching file {fname}: {json_error.get('error')}")
                return None
        except json.JSONDecodeError:
            # Nije JSON, verovatno je fajl, nastavi
            pass
        return r.content
    else:
        st.error(f"Failed to download file {fname}. Status: {r.status_code}, Response: {r.text[:200]}")
        return None

# ─────────── SMTP & auto-task ─────────
def send_mail(subj: str, body: str, att: bytes | None,
              fname: str, s: dict):
    if not all(s.get(k) for k in ["server", "port", "username", "password", "recipients"]):
        st.error("SMTP podešavanja nisu kompletna. Proverite Admin panel.")
        return False
    try:
        msg = EmailMessage()
        msg["Subject"] = subj; msg["From"] = s["username"]; msg["To"] = s["recipients"]
        msg.set_content(body)
        if att:
            # Određivanje mime tipa na osnovu ekstenzije
            maintype, subtype = "application", "octet-stream" # Default
            if fname.lower().endswith(".zip"):
                subtype = "zip"
            elif fname.lower().endswith((".ddd", ".esm", ".c1b", ".v1b")): # Tipične ekstenzije za tahograf
                subtype = "vnd.etsi.asic-e+zip" # Približan MIME za DDD, može biti i 'octet-stream'
            
            msg.add_attachment(att, maintype=maintype,
                               subtype=subtype, filename=fname)
        
        smtp_server = smtplib.SMTP(s["server"], int(s["port"]))
        smtp_server.ehlo() # Pozdrav serveru
        smtp_server.starttls()
        smtp_server.ehlo() # Ponovni pozdrav nakon starttls
        smtp_server.login(s["username"], s["password"])
        smtp_server.send_message(msg)
        smtp_server.quit()
        return True
    except smtplib.SMTPAuthenticationError:
        st.error("SMTP greška: Autentifikacija nije uspela. Proverite korisničko ime i lozinku.")
    except smtplib.SMTPServerDisconnected:
        st.error("SMTP greška: Server je prekinuo vezu. Proverite podešavanja servera i porta, ili da li je TLS/SSL potreban drugačije.")
    except smtplib.SMTPException as e: # Hvata opštije SMTP greške
        st.error(f"SMTP greška: {e}")
    except Exception as e:
        st.error(f"Neočekivana greška prilikom slanja e-maila: {e}")
        traceback.print_exc()
    return False


def schedule_nightly(base: str):
    tmr: threading.Timer | None = st.session_state.get(TIMERKEY)
    if tmr and tmr.is_alive(): tmr.cancel()

    s = st.session_state.get("settings", {}) # Dodat default {} za slučaj da settings ne postoji
    if not s.get("auto_send"): return

    now = datetime.now(EU_BG)
    # Vreme za pokretanje je 02:05 ujutru
    run_time = t(2, 5, tzinfo=EU_BG)
    
    # Ako je sadašnje vreme već prošlo 02:05, planiraj za sutra
    if now.time() >= run_time:
        run_dt = datetime.combine(now.date() + timedelta(days=1), run_time)
    else: # Inače, planiraj za danas
        run_dt = datetime.combine(now.date(), run_time)
        
    delay = (run_dt - now).total_seconds()
    st.sidebar.info(f"Automatsko slanje zakazano za: {run_dt.strftime('%Y-%m-%d %H:%M:%S %Z')}")


    def job():
        st.info(f"[{datetime.now(EU_BG)}] Započinjanje automatskog preuzimanja i slanja DDD fajlova...")
        try:
            settings_for_job = load_settings() # Učitaj najsvežija podešavanja
            sid, baseu = settings_for_job.get("sid"), settings_for_job.get("base_url")
            
            if not sid:
                st.warning("SID nije dostupan za automatski zadatak. Preskačem.")
                return
            if not baseu:
                st.warning("Base URL nije dostupan za automatski zadatak. Preskačem.")
                return

            units = get_units(sid, baseu)
            prev_day_date = (datetime.now(EU_BG) - timedelta(days=1)).date()
            
            all_files_data = [] # Lista parova (putanja_u_zipu, podaci_fajla)
            
            st.info(f"Preuzimanje fajlova za dan: {prev_day_date.strftime('%d.%m.%Y')} za {len(units)} vozila.")
            processed_units_count = 0

            for u in units:
                unit_name_for_path = u["reg"] or u["name"]
                unit_name_for_path = "".join(c if c.isalnum() or c in (' ', '_', '-') else '_' for c in unit_name_for_path).strip() # Sanitizacija imena
                if not unit_name_for_path: unit_name_for_path = f"unit_{u['id']}"

                try:
                    files_for_unit = list_files(sid, u["id"], prev_day_date, baseu)
                    if files_for_unit:
                        st.info(f"Pronađeno {len(files_for_unit)} fajlova za vozilo {unit_name_for_path}.")
                    for f_meta in files_for_unit:
                        file_data = get_file(sid, u["id"], f_meta["n"], baseu)
                        if file_data:
                            zip_path = os.path.join(unit_name_for_path, f_meta["n"])
                            all_files_data.append((zip_path, file_data))
                        else:
                            st.warning(f"Nije uspelo preuzimanje fajla {f_meta['n']} za vozilo {unit_name_for_path}")
                except Exception as e_unit:
                    st.error(f"Greška pri obradi vozila {unit_name_for_path}: {e_unit}")
                processed_units_count +=1
                # st.progress(processed_units_count / len(units)) # Može da izazove probleme u thread-u

            if not all_files_data:
                st.info("Nema fajlova za slanje.")
                send_mail(
                    f"DDD fajlovi {prev_day_date.strftime('%d.%m.%Y')} - Nema podataka",
                    "Automatski zadatak je izvršen, ali nisu pronađeni DDD fajlovi za prethodni dan za bilo koje vozilo.",
                    None, "", settings_for_job
                )
                return

            buf = BytesIO()
            with zipfile.ZipFile(buf, "w", zipfile.ZIP_DEFLATED) as z:
                for zip_path, data_bytes in all_files_data:
                    z.writestr(zip_path, data_bytes)
            buf.seek(0)
            
            zip_filename = f"DDD_SvaVozila_{prev_day_date.strftime('%Y%m%d')}.zip"
            mail_subject = f"DDD fajlovi za {prev_day_date.strftime('%d.%m.%Y')}"
            mail_body = f"Automatski generisana ZIP arhiva sa DDD fajlovima za sva vozila za dan {prev_day_date.strftime('%d.%m.%Y')}."
            
            st.info(f"Slanje email-a sa {len(all_files_data)} fajlova u ZIP arhivi: {zip_filename}")
            if send_mail(mail_subject, mail_body, buf.read(), zip_filename, settings_for_job):
                st.success("Automatski email uspešno poslat.")
            else:
                st.error("Automatski email nije poslat zbog greške.")

        except Exception as e_job:
            st.error(f"Greška u automatskom zadatku: {e_job}")
            traceback.print_exc()
        finally:
            # Ponovo zakazivanje, ali samo ako je 'auto_send' i dalje uključen
            # Ovo osigurava da se ponovo zakaže čak i ako je došlo do greške u 'job'
            # Ali moramo učitati podešavanja ponovo da proverimo 'auto_send'
            current_settings = load_settings()
            if current_settings.get("auto_send"):
                 # Osiguravamo da se ne zakaže previše puta brzo ako petlja grešaka postoji
                st.info("Ponovno zakazivanje noćnog zadatka...")
                # Koristimo base_url iz trenutnih podešavanja za sledeće zakazivanje
                schedule_nightly(current_settings.get("base_url", base))
            else:
                st.info("Automatsko slanje je isključeno, noćni zadatak se ne zakazuje ponovo.")


    tmr = threading.Timer(delay, job)
    tmr.daemon = True
    add_script_run_ctx(tmr)
    tmr.start()
    st.session_state[TIMERKEY] = tmr

# ─────────── UI ───────────
def set_bg_hack(main_bg_img_base64):
    '''
    Funkcija za postavljanje pozadinskog loga.
    main_bg_img_base64: Base64 string slike.
    '''
    # CSS za pozadinu
    # Koristimo pseudo-element ::before na body da bismo izbegli da opacity utiče na sadržaj.
    # Streamlit tema (svetla/tamna) može uticati na vidljivost, pa je važno da .stApp ili kontejneri imaju transparentnu pozadinu.
    page_bg_img = f'''
    <style>
    body::before {{
        content: "";
        position: fixed; /* Ili absolute ako želite da se skroluje sa stranicom */
        left: 0;
        top: 0;
        width: 100vw;
        height: 100vh;
        background-image: url("{main_bg_img_base64}");
        background-repeat: no-repeat;
        background-position: center center;
        background-size: contain; /* 'contain' da ceo logo bude vidljiv, 'cover' da prekrije ceo prostor */
        opacity: 0.05; /* Podesite prozirnost po želji (0.0 do 1.0) */
        z-index: -1; /* Postavlja logo iza sadržaja */
    }}
    /* Osigurava da glavni kontejner aplikacije bude proziran da bi se video logo */
    /* Možda će biti potrebno dodatno prilagođavanje u zavisnosti od Streamlit verzije i tema */
    .stApp {{
        background-color: transparent !important;
    }}
    [data-testid="stHeader"], [data-testid="stSidebar"] {{
        background-color: rgba(250, 250, 250, 0.8) !important; /* Blago prozirna pozadina za header i sidebar na svetloj temi */
    }}
    /* Za tamnu temu, ako je koristite */
    html[data-theme="dark"] [data-testid="stHeader"],
    html[data-theme="dark"] [data-testid="stSidebar"] {{
         background-color: rgba(20, 20, 20, 0.8) !important; /* Blago prozirna pozadina za header i sidebar na tamnoj temi */
    }}
    </style>
    '''
    st.markdown(page_bg_img, unsafe_allow_html=True)


def main():
    st.set_page_config("Wialon DDD Manager", layout="wide", initial_sidebar_state="expanded")

    # Postavljanje pozadinskog loga
    if LOGO_BASE64 and "YOUR_BASE64_ENCODED_LOGO_STRING_HERE" not in LOGO_BASE64:
        set_bg_hack(LOGO_BASE64)
    else:
        st.sidebar.warning("Logo nije konfigurisan. Zamenite placeholder u kodu.")


    qs = st.experimental_get_query_params()
    # Obezbeđivanje da base_url uvek ima http/https prefiks ako ga nema
    default_base_url = "https://hst-api.wialon.com"
    raw_base_url = unquote_plus(qs.get("baseUrl", [default_base_url])[0])
    if not raw_base_url.startswith(("http://", "https://")):
        raw_base_url = "https://" + raw_base_url # Default na https ako nema prefiksa
    
    base_url = normalize_base_url(raw_base_url)
    sid_qs   = qs.get("sid", [None])[0]

    if "settings" not in st.session_state:
        st.session_state["settings"] = load_settings()
        # Inicijalno zakazivanje ako je auto_send uključen i podešavanja učitana
        # Ovo će se desiti samo jednom po sesiji ako su podešavanja već učitana i auto_send je true
        # schedule_nightly(st.session_state["settings"].get("base_url", base_url))
        # Ne, ovo treba pozvati samo nakon što su podešavanja sačuvana ili nakon logina

    s = st.session_state["settings"]
    s.setdefault("base_url", base_url) # Postavi default ako nije već u podešavanjima
    if sid_qs: 
        s["sid"] = sid_qs
        # Ako se SID dobije preko query string-a, možda želimo da sačuvamo nova podešavanja
        # save_settings(s) # Opciono, zavisi od željene logike


    page = st.sidebar.radio("Navigacija", ["Preuzimanje Fajlova", "Administracija"], key="navigacija")

    # --- Provera konekcije i SID-a pre nego što se iscrta ostatak UI ---
    # Ovo je bitno da bi se izbegle greške ako SID nije validan ili je istekao.
    # Pokušaj da se dobiju jedinice ako SID postoji, da se testira validnost.
    initial_login_successful = False
    if s.get("sid"):
        try:
            # Test poziv da se vidi da li je SID validan
            wialon_call("core/search_item", s["sid"], {"id": 0, "flags": 1}, s["base_url"])
            initial_login_successful = True
            # Ako je auto_send uključen i timer nije pokrenut, pokreni ga
            if s.get("auto_send") and not st.session_state.get(TIMERKEY):
                 schedule_nightly(s["base_url"])

        except (requests.exceptions.RequestException, RuntimeError) as e:
            st.sidebar.error(f"SID nije validan ili Wialon nije dostupan: {e}. Prijavite se ponovo.")
            s.pop("sid", None) # Ukloni nevalidan SID
            save_settings(s)   # Sačuvaj promenu
            initial_login_successful = False
            # Ovde bi bilo dobro da se otkaže tajmer ako postoji
            tmr: threading.Timer | None = st.session_state.get(TIMERKEY)
            if tmr and tmr.is_alive():
                tmr.cancel()
                st.session_state.pop(TIMERKEY, None)
                st.sidebar.info("Automatsko slanje zaustavljeno zbog nevalidnog SID-a.")
        
    # ─── Administracija (lozinka) ───
    if page == "Administracija":
        st.header("🔐 Admin Panel")
        if s.get("admin_pw_hash"):
            if not st.session_state.get("admin_ok"):
                pwd = st.sidebar.text_input("Admin lozinka", type="password", key="admin_pwd_login")
                if st.sidebar.button("Login u Admin Panel", key="admin_login_btn"):
                    if sha(pwd) == s["admin_pw_hash"]:
                        st.session_state["admin_ok"] = True
                        st.experimental_rerun()
                    else:
                        st.sidebar.error("Pogrešna lozinka")
                st.info("Unesite admin lozinku u sidebar-u za pristup podešavanjima.")
                st.stop()
        else:
            st.sidebar.info("Nije postavljena admin lozinka. Postavite je da biste osigurali podešavanja.")
            npw = st.sidebar.text_input("Nova Admin lozinka", type="password", key="admin_set_initial_pwd")
            if st.sidebar.button("Postavi Admin lozinku", key="admin_set_initial_pwd_btn"):
                if npw:
                    s["admin_pw_hash"] = sha(npw)
                    save_settings(s)
                    st.session_state["admin_ok"] = True # Automatski login nakon postavljanja
                    st.sidebar.success("Admin lozinka postavljena i sačuvana.")
                    st.experimental_rerun()
                else:
                    st.sidebar.error("Lozinka ne može biti prazna.")
            st.stop()

        
        with st.expander("Promena Admin Lozinke", expanded=False):
            npw_change = st.text_input("Nova admin lozinka za promenu", type="password", key="admin_change_pwd")
            if st.button("Sačuvaj novu admin lozinku", key="admin_change_pwd_btn"):
                if npw_change:
                    s["admin_pw_hash"] = sha(npw_change)
                    save_settings(s)
                    st.success("Admin lozinka uspešno promenjena.")
                    st.experimental_rerun() # Da osveži stanje
                else:
                    st.error("Nova lozinka ne može biti prazna.")

        st.subheader("Wialon Podešavanja")
        s["base_url"] = normalize_base_url(st.text_input("Wialon Base URL", s.get("base_url", default_base_url)))
        s["token"] = st.text_input("Wialon Token", s.get("token", DEFAULT_TOKEN), type="password", help="Token za automatsku prijavu ako SID istekne ili nije prisutan.")
        
        st.subheader("SMTP Podešavanja za Slanje E-maila")
        s["server"] = st.text_input("SMTP Server", s.get("server", ""))
        s["port"]   = st.text_input("SMTP Port",   s.get("port", "587"))
        s["username"]= st.text_input("SMTP Korisničko ime", s.get("username", ""))
        s["password"]= st.text_input("SMTP Lozinka", s.get("password", ""), type="password")
        s["recipients"]= st.text_input("Primaoci E-maila (odvojeni zarezom)", s.get("recipients", ""), help="Npr. email1@example.com,email2@example.com")

        current_auto_send_val = s.get("auto_send", False)
        s["auto_send"] = st.checkbox("Noćno automatsko slanje e-maila (oko 02:05h)", value=current_auto_send_val, key="auto_send_cb")

        col1_admin, col2_admin, col3_admin = st.columns(3)
        with col1_admin:
            if st.button("Sačuvaj Podešavanja", key="save_settings_btn", type="primary"):
                save_settings(s)
                st.success("Podešavanja su sačuvana.")
                 # Ako je auto_send promenjen, ažuriraj tajmer
                if s["auto_send"] and (not st.session_state.get(TIMERKEY) or not st.session_state.get(TIMERKEY).is_alive()):
                    schedule_nightly(s["base_url"])
                    st.info("Automatsko slanje aktivirano i zakazano.")
                elif not s["auto_send"] and st.session_state.get(TIMERKEY) and st.session_state.get(TIMERKEY).is_alive():
                    st.session_state[TIMERKEY].cancel()
                    st.session_state.pop(TIMERKEY, None)
                    st.info("Automatsko slanje deaktivirano.")
                st.experimental_rerun() # Da se osveži stanje UI

        with col2_admin:
            if st.button("Testiraj E-mail Podešavanja", key="test_email_btn"):
                if send_mail("Test Wialon DDD Manager", "Ovo je test poruka za proveru SMTP podešavanja.", None, "", s):
                    st.success("Test e-mail uspešno poslat!")
                # Greška će biti prikazana unutar send_mail funkcije

        with col3_admin:
            if st.button("Odjava iz Admin Panela", key="admin_logout_btn"):
                st.session_state.pop("admin_ok", None)
                st.experimental_rerun()
                
    # ─── Files (nova postavka) ───
    elif page == "Preuzimanje Fajlova":
        st.header("📁 Preuzimanje DDD Fajlova")
        if not s.get("sid") or not initial_login_successful: # Provera i initial_login_successful
            st.subheader("Prijava na Wialon")
            login_token_val = s.get("token", DEFAULT_TOKEN)
            if not login_token_val:
                 st.warning("Wialon token nije podešen. Molimo unesite token u Admin panelu.")
            
            if st.button("Prijavi se koristeći Wialon Token", key="login_with_token_btn", disabled=not login_token_val):
                sid = login_token(login_token_val, s["base_url"])
                if sid:
                    s["sid"] = sid
                    save_settings(s) # Sačuvaj novi SID
                    st.success("Uspešno prijavljen!")
                    # Nakon uspešne prijave, pokreni noćni tajmer ako je auto_send uključen
                    if s.get("auto_send"):
                        schedule_nightly(s["base_url"])
                    st.experimental_rerun()
                # Greška će biti prikazana unutar login_token funkcije
            st.markdown("---")
            st.info("Ako SID nije automatski prepoznat (npr. iz URL-a) ili je istekao, koristite dugme iznad za prijavu tokenom. Token i Wialon URL se podešavaju u Admin panelu.")
            st.stop()

        try:
            units = get_units(s["sid"], s["base_url"])
            if not units:
                st.warning("Nema dostupnih vozila (jedinica) na vašem Wialon nalogu.")
                st.stop()
        except requests.exceptions.RequestException as re:
            st.error(f"Greška u komunikaciji sa Wialon serverom: {re}")
            s.pop("sid", None); save_settings(s) # Ukloni nevalidan SID
            st.experimental_rerun()
            st.stop()
        except RuntimeError as e: # Hvata Wialon greške definisane u wialon_call
            st.error(f"Wialon API greška: {e}")
            if "Invalid session" in str(e) or "Error code 4" in str(e) or "Error code 2" in str(e): # Error code 4 je često za nevalidan SID
                s.pop("sid", None); save_settings(s) # Ukloni nevalidan SID
                st.warning("Sesija je istekla ili nije validna. Molimo prijavite se ponovo.")
                st.experimental_rerun()
            st.stop()
        except Exception as e: # Hvata ostale nepredviđene greške
            st.error(f"Neočekivana greška prilikom dobavljanja liste vozila: {e}")
            traceback.print_exc()
            st.stop()


        col_left, col_right = st.columns([1, 2])

        with col_left:
            st.subheader("Izbor Vozila i Datuma")
            day = st.date_input("Datum za pretragu fajlova", datetime.now(EU_BG).date() - timedelta(days=1), key="datum_fajlova", help="Birate datum za koji želite DDD fajlove.")
            
            q_search_placeholder = "Pretraga po imenu ili registraciji..."
            q = st.text_input("Pretraga vozila", "", placeholder=q_search_placeholder, key="pretraga_vozila").lower()
            
            filtered_units = [u for u in units if q in (u.get("reg", "") + u.get("name", "")).lower()]
            
            if not filtered_units:
                st.warning("Nema vozila koja odgovaraju pretrazi.")
                st.stop()

            # Kreiranje labela za radio dugmad
            unit_labels = []
            for u in filtered_units:
                label_parts = []
                if u.get("reg"): label_parts.append(u["reg"])
                if u.get("name"): label_parts.append(u["name"])
                unit_labels.append(" — ".join(label_parts) if label_parts else f"Vozilo ID: {u['id']}")
            
            # Provera jedinstvenosti labela, ako nisu, dodaj ID
            if len(unit_labels) != len(set(unit_labels)):
                unit_labels_with_id = []
                for i, u in enumerate(filtered_units):
                    base_label = unit_labels[i]
                    if unit_labels.count(base_label) > 1:
                         unit_labels_with_id.append(f"{base_label} (ID: {u['id']})")
                    else:
                        unit_labels_with_id.append(base_label)
                unit_labels = unit_labels_with_id


            if not unit_labels: # Dodatna provera ako je lista prazna
                st.warning("Nema vozila za prikaz nakon filtriranja labela.")
                st.stop()
            
            selected_label_radio = st.radio(
                "Izaberite vozilo:", unit_labels, index=0, key="radio_vozilo_select"
            )
            
            # Pronalaženje izabranog unit objekta na osnovu selektovane labele
            # Ovo mora biti pažljivije ako labele nisu jedinstvene
            selected_unit = None
            for i, u_label in enumerate(unit_labels):
                if u_label == selected_label_radio:
                    selected_unit = filtered_units[i]
                    break
            
            if not selected_unit: # Fallback ako nešto krene po zlu
                st.error("Greška pri izboru vozila.")
                st.stop()

        with col_right:
            unit_display_name = selected_unit.get("reg") or selected_unit.get("name") or f"ID: {selected_unit['id']}"
            st.subheader(f"Fajlovi za: **{unit_display_name}**")
            st.markdown(f"Datum: **{day.strftime('%d.%m.%Y')}**")

            try:
                files = list_files(s["sid"], selected_unit["id"], day, s["base_url"])
            except RuntimeError as e:
                st.error(f"Wialon API greška pri listanju fajlova: {e}")
                st.stop()
            except Exception as e:
                st.error(f"Neočekivana greška pri listanju fajlova: {e}")
                traceback.print_exc()
                st.stop()

            if not files:
                st.info("Nema dostupnih fajlova za izabrano vozilo i datum.")
                st.stop()

            st.markdown("##### Izaberite fajlove:")
            checked_files_data = {} # Rečnik za čuvanje stanja checkbox-a: {fname: bool}
            
            # Dugmad za "Označi sve" / "Poništi sve"
            c_all, c_none = st.columns(2)
            select_all_key = f"select_all_{selected_unit['id']}_{day}"
            deselect_all_key = f"deselect_all_{selected_unit['id']}_{day}"

            if c_all.button("Označi sve", key=select_all_key):
                for f_meta in files:
                    st.session_state[f"cb_{selected_unit['id']}_{f_meta['n']}"] = True
                st.experimental_rerun() # Da se osveže checkbox-ovi

            if c_none.button("Poništi sve", key=deselect_all_key):
                for f_meta in files:
                    st.session_state[f"cb_{selected_unit['id']}_{f_meta['n']}"] = False
                st.experimental_rerun()


            for f_meta in files:
                # Koristimo st.session_state za perzistenciju stanja checkbox-a
                checkbox_key = f"cb_{selected_unit['id']}_{f_meta['n']}"
                if checkbox_key not in st.session_state:
                    st.session_state[checkbox_key] = False # Default na neoznačeno
                
                is_checked = st.checkbox(
                    f"{f_meta['n']} (Veličina: {f_meta.get('s', 0)//1024} KB, Modifikovan: {datetime.fromtimestamp(f_meta.get('mt', 0), EU_BG).strftime('%d.%m.%Y %H:%M:%S') if f_meta.get('mt') else 'N/A'})", 
                    key=checkbox_key,
                    value=st.session_state[checkbox_key] # Postavi vrednost iz session_state
                )
                if is_checked:
                    checked_files_data[f_meta['n']] = True
            
            selected_file_names = [fname for fname, is_sel in checked_files_data.items() if is_sel]

            st.markdown("---")
            if not selected_file_names:
                st.info("Niste izabrali nijedan fajl za preuzimanje ili slanje.")
                st.stop()

            st.markdown(f"**Izabrano fajlova: {len(selected_file_names)}**")
            
            action_col1, action_col2 = st.columns(2)

            with action_col1: # DOWNLOAD Akcija
                file_prefix = "".join(c if c.isalnum() else '_' for c in (selected_unit.get("reg") or selected_unit.get("name", str(selected_unit["id"]))))
                download_filename_single = selected_file_names[0] if len(selected_file_names) == 1 else None
                download_filename_zip = f"{file_prefix}_{day.strftime('%Y%m%d')}.zip"

                if len(selected_file_names) == 1:
                    fname_single = selected_file_names[0]
                    # Dugme je uvek vidljivo, ali preuzimanje se dešava on-the-fly
                    if st.button(f"Preuzmi: {fname_single}", key=f"download_single_{selected_unit['id']}_{fname_single}"):
                        with st.spinner(f"Preuzimanje fajla {fname_single}..."):
                            file_bytes = get_file(s["sid"], selected_unit["id"], fname_single, s["base_url"])
                        if file_bytes:
                            # Nudimo download kroz st.download_button, ali ga aktiviramo tek nakon klika
                            # Ovaj pristup je malo nezgrapan, bolji je direktan download_button ako je moguće
                            st.download_button(
                                label=f"Kliknite ovde za preuzimanje {fname_single}",
                                data=file_bytes,
                                file_name=fname_single,
                                mime="application/octet-stream",
                                key=f"actual_dl_btn_single_{selected_unit['id']}_{fname_single}"
                            )
                            st.success(f"Fajl {fname_single} je spreman za preuzimanje.")
                        else:
                            st.error(f"Nije uspelo preuzimanje fajla {fname_single}.")
                else: # Više fajlova -> ZIP
                    # Dugme je uvek vidljivo
                    if st.button(f"Preuzmi ZIP ({len(selected_file_names)} fajlova)", key=f"download_zip_{selected_unit['id']}"):
                        zip_buffer = BytesIO()
                        with st.spinner(f"Kreiranje ZIP arhive za {len(selected_file_names)} fajlova..."):
                            with zipfile.ZipFile(zip_buffer, "w", zipfile.ZIP_DEFLATED) as zf:
                                for i, fname_to_zip in enumerate(selected_file_names):
                                    # st.progress((i+1)/len(selected_file_names)) # Može biti sporo za mnogo fajlova
                                    file_bytes = get_file(s["sid"], selected_unit["id"], fname_to_zip, s["base_url"])
                                    if file_bytes:
                                        zf.writestr(fname_to_zip, file_bytes)
                                    else:
                                        st.warning(f"Fajl {fname_to_zip} nije mogao biti preuzet i dodat u ZIP.")
                        zip_buffer.seek(0)
                        st.download_button(
                            label=f"Kliknite ovde za preuzimanje {download_filename_zip}",
                            data=zip_buffer,
                            file_name=download_filename_zip,
                            mime="application/zip",
                            key=f"actual_dl_btn_zip_{selected_unit['id']}"
                        )
                        st.success(f"ZIP arhiva {download_filename_zip} je spremna za preuzimanje.")


            with action_col2: # EMAIL Akcija
                email_button_label = f"Pošalji E-mail ({len(selected_file_names)} fajl{'a' if len(selected_file_names) > 1 and len(selected_file_names) < 5 else 'ova'})"
                if st.button(email_button_label, key=f"email_files_{selected_unit['id']}"):
                    if not all(s.get(k) for k in ["server", "port", "username", "password", "recipients"]):
                        st.error("SMTP podešavanja nisu kompletna. Molimo proverite Admin panel pre slanja emaila.")
                    else:
                        attachment_bytes = None
                        attachment_filename = ""
                        email_subject = f"DDD fajlovi za vozilo: {unit_display_name} ({day.strftime('%d.%m.%Y')})"
                        email_body = f"U prilogu se nalaze izabrani DDD fajlovi za vozilo {unit_display_name} za datum {day.strftime('%d.%m.%Y')}.\n\nIzabrani fajlovi:\n" + "\n".join(selected_file_names)

                        with st.spinner("Priprema fajlova za slanje emailom..."):
                            if len(selected_file_names) == 1:
                                fname_email_single = selected_file_names[0]
                                attachment_bytes = get_file(s["sid"], selected_unit["id"], fname_email_single, s["base_url"])
                                attachment_filename = fname_email_single
                            else:
                                zip_buffer_email = BytesIO()
                                with zipfile.ZipFile(zip_buffer_email, "w", zipfile.ZIP_DEFLATED) as zf_email:
                                    for fname_to_email_zip in selected_file_names:
                                        file_bytes_email = get_file(s["sid"], selected_unit["id"], fname_to_email_zip, s["base_url"])
                                        if file_bytes_email:
                                            zf_email.writestr(fname_to_email_zip, file_bytes_email)
                                zip_buffer_email.seek(0)
                                attachment_bytes = zip_buffer_email.read()
                                attachment_filename = f"{file_prefix}_{day.strftime('%Y%m%d')}_email.zip"
                        
                        if attachment_bytes:
                            if send_mail(email_subject, email_body, attachment_bytes, attachment_filename, s):
                                st.success("E-mail uspešno poslat!")
                            # Greška će biti prikazana unutar send_mail
                        else:
                            st.error("Nije bilo moguće pripremiti fajlove za slanje (možda su prazni ili je došlo do greške pri preuzimanju).")
        
        st.markdown("---")
        st.info("""
        **Napomene:**
        - Za obradu DDD fajlova (analiza aktivnosti vozača, prekršaji, itd.) koristite specijalizovani softver. Ova aplikacija služi samo za preuzimanje fajlova sa Wialon platforme.
        - Ako automatsko noćno slanje ne radi, proverite da li je SID validan (prijavite se ponovo ako je potrebno) i da li su SMTP podešavanja ispravna u Admin panelu.
        - Da bi aplikacija ostala "budna" na Streamlit Community Cloud-u, razmislite o korišćenju eksternog "ping" servisa kao što je UptimeRobot.
        """)


# ─────────── entrypoint ───────────
if __name__ == "__main__":
    main()
